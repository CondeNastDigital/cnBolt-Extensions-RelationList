<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="bundle.web.js"></script>
    <link rel="stylesheet" href="./dist/styles.min.css" />
    <link rel="stylesheet" href="http://gewinnspiele.gq.local/gewinnspiele/bolt-public/css/lib.css?05df30316e">
    <link rel="stylesheet" href="http://gewinnspiele.gq.local/gewinnspiele/bolt-public/css/bolt.css?e7285bef53">

    <style>
        .row.itemlist{
            height: 600px;
            max-height: none;
        }
    </style>

</head>
<body>

    <div id="relationlist" class="form-control">
        <app></app>
    </div>

    <!-- OLD STRING -->
    <label>old</label>
    <textarea id="connector" style="width:100%;height:150px">
    {"globals":{"best":"Bademode"},"items":["teasers/5","teasers/6","competitions/58"],"attributes":{"teasers/5":{"isopen":false,"number":"0"},"teasers/6":{"isopen":false,"number":"0"},"competitions/58":{}}}
    </textarea>

    <!-- NEW STRING -->
    <label>new</label>
    <textarea id="connector2" style="width:100%;height:150px">
        {"status":true,"items":[{"id":"competitions/50","service":"content","type":"competitions","attributes":{"test":"1111", "west":"2222"}}]}
    </textarea>

    <script type="application/javascript">

        $(function () {

            let definitions = JSON.stringify({
                globals: {
                    test: {
                        label: 'Global Field',
                        type: 'text'
                    },
                    best: {
                        label: 'Global Field 2',
                        type: 'autocomplete',
                        multiple: true,
                        taggable: true,
                        endpoints: [
                            'https://kraken.condenastdigital.de/api/content/tags?search={{query}}',
                            'http://newsletters.local/bolt/relationlist/autocomplete/taxonomies/tag?search={{query}}'
                        ]
                    }
                },
                attributes: {
                    test: {
                        label: 'Item Field',
                        type: 'text'
                    },

                    west: {
                        label: 'Item Field WEST',
                        type: 'text'
                    }

                }
            });
            var connector = '#connector';
            var searchurl  = "http://gewinnspiele.gq.local/gewinnspiele/bolt/relationlist/search/homes/teasers/";
            var fetchurl =   "http://gewinnspiele.gq.local/gewinnspiele/bolt/relationlist/fetch";

            var value = $(connector).val() || '{}';
            var options = {
                searchurl: searchurl,
                fetchurl: fetchurl,
                element: '#relationlist',
                validation: {}
            };

            options.validation.min = "1";
            options.validation.max = "10";

            let cnRelationList = new CnRelationList({
                options: options,
                value: value,
                definitions: definitions,
                onRelationUpdated: function (data) {
                    $(connector).val(JSON.stringify(data));
                }
            });
        });

    </script>

    <div style="height: 3000px;background-color: #ffcccc">
        Hello, I am just scrolling around!
    </div>

</body>
</html>
